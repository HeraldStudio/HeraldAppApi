# 话题设计

### 目的：增加用户互动，提高黏度及闲时开启频率，促进东大文化交流氛围

### 功能简介：1. 管理员发布话题       2.用户评论话题    3.用户对他人评论进行点赞、评论、分享

### 系统设计：1. 话题简略信息：话题名、 简略介绍（考虑为介绍前x个字）、浏览数、评论数

### 2. 话题详细信息：话题名、评论列表（评论内容及其点赞数、评论时间、评论用户；评论的评论内容、点赞数），评论支持一级回复

​    

### 3. 话题评论排序：每次刷新显示前x+y条，前x条为前x名，x+1 - y条为在其他评论中随机抽，按时间排序

### 4.其他：支持匿名评论

 @attention：使用前评论表需插入一项，评论id为1

# 请求码设计

| askcode值 | 描述            |
| -------- | ------------- |
| 101      | 发布话题          |
| 102      | 删除话题          |
| 103      | 评论话题          |
| 104      | 删除评论          |
| 105      | 给评论点赞         |
| 106      | 取消赞           |
| 107      | 返回某个话题前x名评论   |
| 108      | 返回某个话题后y个随机评论 |
|          | 返回某个评论的所有回复   |

## 101发布话题：

| 字段      | 示例        | 功能   |
| ------- | --------- | ---- |
| askcode | 101       | 请求码  |
| cardnum | 213141224 | 一卡通号 |
| name    | 第一个话题     | 话题名  |
| content | 没有什么内容    | 话题内容 |

### 返回值实例：

成功：

```json
{
  "content": "添加话题成功", 
  "code": "200"
}
```

重复：

```json
{
  "content": "该话题已存在", 
  "code": "200"
}
```

   

## 102删除话题：

| 字段      | 示例        | 功能   |
| ------- | --------- | ---- |
| askcode | 102       | 请求码  |
| cardnum | 213141224 | 一卡通号 |
| tid     | 1         | 话题Id |

### 返回值实例：

```json
{
  "content": "删除成功", 
  "code": 200
}
```

```json
{
  "content": "该话题不存在或已删除", 
  "code": 200
}
```


## 103:评论话题：

| 字段      | 示例        | 功能                                       |
| ------- | --------- | ---------------------------------------- |
| askcode | 103       | 请求码                                      |
| cardnum | 213141224 | 一卡通号                                     |
| tid     | 1         | 评论id                                     |
| quo     | 1         | 评论引用，为评论Id，作为评论的回复。如果为直接评论话题，则值为1（默认评论值）， |
| ano     | 0         | 是否为匿名，1为匿名，0为不匿名                         |
| content | 第一个评论     | 评论内容                                     |

### 返回值实例：

```json
{
  "content": "评论成功", 
  "code": "200"
}
```

```json
{
  "content": "该评论已存在", 
  "code": "200"
}
```

## 104：删除评论

| 字段      | 示例        | 功能        |
| ------- | --------- | --------- |
| askcode | 104       | 请求码       |
| cardnum | 213141240 | 一卡通号      |
| cid     | 9         | 要删除的评论的Id |

### 返回值示例

```json
{
  "content": "删除成功", 
  "code": "200"
}
```

```json
{
  "content": "该评论不存在或已删除", 
  "code": "200"
}
```
## 105:给评论点赞

| 字段      | 示例        | 功能   |
| ------- | --------- | ---- |
| askcode | 105       | 请求码  |
| cardnum | 213141240 | 一卡通号 |
| cid     | 8         | 评论id |

返回值实例：

```json
{
  "content": "点赞成功", 
  "code": "200"
}
```

```json
{
  "content": "失败，之前已点过赞", 
  "code": "200"
}
```

## 106取消赞

| 字段      | 示例        | 功能   |
| ------- | --------- | ---- |
| askcode | 106       | 请求码  |
| cardnum | 213141240 | 一卡通号 |
| cid     | 8         | 评论id |

### 返回值实例

```json
{
  "content": "取消赞成功", 
  "code": "200"
}
```

```json
{
  "content": "无点赞记录", 
  "code": "200"
}
```
## 107返回某个话题前x名评论

| 字段      | 示例        | 功能   |
| ------- | --------- | ---- |
| askcode | 107       | 请求码  |
| cardnum | 213141240 | 一卡通号 |

### 返回值实例

```json
{
  "content": [
    {
      "content": "评论话题第二次测试", 
      "likeN": 3, 
      "cardnum": "213141240", 
      "time": "2016-10-04 18:40:16"
    }, 
    {
      "content": "评论话题第一次测试", 
      "likeN": 0, 
      "cardnum": "213141240", 
      "time": "2016-10-04 18:32:24"
    }, 
    {
      "content": "评论话题第三次测试", 
      "likeN": 0, 
      "cardnum": "213141240", 
      "time": "2016-10-04 19:54:45"
    }
  ], 
  "code": "200"
}
```



## 108:返回某个话题随机个评论



### 返回值实例

```
{
  "content": [
    {
      "content": "评论话题第一次测试", 
      "likeN": 0, 
      "cardnum": "213141240", 
      "time": "2016-10-04 18:32:24"
    }, 
    {
      "content": "评论话题第三次测试", 
      "likeN": 0, 
      "cardnum": "213141240", 
      "time": "2016-10-04 19:54:45"
    }
  ], 
  "code": "200"
}
```