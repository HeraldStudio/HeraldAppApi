---
title: 快递接口模块
layout: post
date: 2016-08-10 09:29:44
tags: HeraldStudio

---


## 快递模块接口文档

## 目录

[错误代码](#错误代码集合)

> for user

[取快递时间列表](#获取时间列表)

[提交订单](#提交订单)

[查询订单状态](#查询订单状态)

[一卡通查询记录](#一卡通查询记录)

[删除提交的订单](#已经提交的记录进行删除)

> for administrator

[查询所有订单](#查询所有订单)

[查询快递订单数目](#查询快递订单数目)

[修改订单状态](#修改订单状态)

### 错误代码集合

* 所有接口如不做特殊说明, 均为`post`请求, 返回均为`json`字符串
* 所有服务器地址均以`127.0.0.1`代替

* 所有错误代码如下

| code  | 原因          |
| ----- | -----       |
| 300   | 参数缺少        |
| 301   | 用户不存在       |
| 302   | 请先登录        |
| 303   | 参数错误        |
| 304   | 快件已有人接单     |
| 305   | 用户错误        |
| 400   | 密码错误        |
| 401   | 密码太短        |
| 402   | 手机格式不正确     |
| 403   | 手机号已被注册     |
| 404   | 验证码格式不正确    |
| 405   | 验证码已过期      |
| 406   | 验证码不正确      |
| 407   | 已达到每日最大发送次数 |
| 408   | 发送间隔小于两分钟   |
| 409   | 参数格式错误      |
| 500   | 系统错误        |

* 错误代码以如下形式返回

```json
{
  "content": "参数太少", 
  "code": 300
}
```

### 获取时间列表

[http://127.0.0.1:8080/kuaidi/getTimeList](http://127.0.0.1:8080/kuaidi/getTimeList)

返回示例

```json
{
  "content": [
    "次日12:20~12:40", 
    "次日17:40~18:00"
  ], 
  "code": 200
}
```

### 提交订单

[http://127.0.0.1:8080/kuaidi/submit](http://127.0.0.1:8080/kuaidi/submit)

| 字段             | 示例            | 功能             |
| -------------- | ------------  | : ---------- : |
| user_name      | xxx           | 用户姓名           |
| user_phone     | 15189800598   | 用户手机号码         |
| uuid           | 12...         | 用户uuid         |
| sms_txt        | 简短的短信         | 收到的短息          |
| dest           | 梅九大厅          | 客户取快递地点        |
| arrival        | 中午12:20-12:40 | 客户取快递时间        |
| locate         | 东门            | 快递所在地          |
| weight         | 小于4斤          | 快递重量           |

> `dest`:
    1. 梅九大厅
    2. 桃三四大厅

> `arrival`:
    1. 中午12:20～12:40
    2. 下午5:40～6;00

> `locate`:
    1. 东门
    2. 南门

> `weight`:
    1. 小于4斤
    2. 4~8斤
    3. 8斤以上

返回示例:

```json
{
  "content": {
    "sub_time": "1470790708"
  }, 
  "code": 200
}

```

`sub_time`为`python`时间戳, 不同编程语言可能需要进行转换

### 查询订单状态
[http://127.0.0.1:8080/kuaidi/queryState](http://127.0.0.1:8080/kuaidi/queryState)

| 字段         | 示例          | 功能         |
| -----      | -----       | ----       |
| user_phone | 15189800598 | 手机号码       |
| sub_time   | 1470790708  | python 时间戳 |

| 字段           | 含义                 |
| ------------ | :-----------:      |
| `finish`     | 订单完成状况             |
| `receiving`  | 是否有人接单(接单之后不可以再修改) |

返回示例:

```json
{
  "content": {
    "finish": false, 
    "receiving": false
  }, 
  "code": 200
}
```


### 一卡通号查询记录

[http://127.0.0.1:8080/kuaidi/queryByCard](http://127.0.0.1:8080/kuaidi/queryByCard)

| 字段       | 示例        | 功能    |
| -----    | -----     | ----  |
| card_num | 21314xxxx | 一卡通号码 |

返回示例:

```json
{
  "content": [
    {
      "arrival": "中午12:20~12:40", 
      "phone": "17865185736", 
      "finish": false, 
      "user": "feng yu hao", 
      "weight": "小于4斤", 
      "dest": "桃三四", 
      "locate": "东门", 
      "sub_time": "1470657951", 
      "receiving": false, 
      "sms": "这是一个简短类似的短信的Text, 不知道这个效果怎么样"
    }, 
    ...
  ], 
  "code": 200
}
```


### 已经提交的记录进行删除

[http://127.0.0.1:8080/kuaidi/deleteRecord](http://127.0.0.1:8080/kuaidi/deleteRecord)


| 字段         | 示例          | 功能   |
| -----      | -----       | ---- |
| uuid       | f3...       | uuid |
| user_phone | 15189800598 | 手机号码 |
| sub_time   | 1470790487  | 时间戳  |

返回示例:

```json
{
  "content": "操作成功", 
  "code": 200
}
```

### 查询所有订单

[http://127.0.0.1:8080/kuaidi/queryAll](http://127.0.0.1:8080/kuaidi/queryAll)

此接口为查询可以查询所有记录, 但是默认返回0-5条记录, 

| 字段       | 示例        | 功能      |
| -------- |:---------:| ------- |
| start    | 0         | 返回记录开始  |
| end      | 5         | 返回记录结束  |

返回结果示例

```json
{
  "content": [
    {
      "arrival": "中午12:20~12:40", 
      "phone": "15189800598", 
      "finish": false, 
      "user": "冯裕浩", 
      "weight": "小于4斤", 
      "dest": "梅九大厅", 
      "locate": "东门", 
      "sub_time": "1472343649", 
      "receiving": false, 
      "sms": "这是一条简短信息,  在取快递时, 短信是应当被出示的, 因此这一项是应该有的内容"
    } ...
  ], 
  "code": 200
}
```

### 查询快递订单数目

[http://127.0.0.1:8080/kuaidi/queryCount](http://127.0.0.1:8080/kuaidi/queryCount)

此接口与查询接口配合使用, 可以达到分页的效果

content 中即为当前订单数目

```json
{
  "content": 2, 
  "code": 200
}
```

### 修改订单状态

[http://127.0.0.1:8080/kuaidi/modifyState](http://127.0.0.1:8080/kuaidi/modifyState)

此接口为修改信息接口

| 字段         | 示例                            | 功能      |
| --------   | ---------                     | ------- |
| state_json | {"content": [], "user_id":""} | 修改相关信息  |

完整示例如下

```json
{     
  "content":[
    {
      "user_phone": "17865185736",             
      "sub_time": 1470881998,             
      "finish": 0,             
      "received": 1         
    },         
    {
      "user_phone": "15189800598",             
      "sub_time": 1470806132,             
      "finish": 0,             
      "received": 1         
    }     
  ],     
  "user_id": "my_user" 
}
```

* 本地请求可能会因为访问远程数据库而影响速度, 可能修改会花几秒钟时间,
* 请严格按照格式填写, 希望请求时避免一次修改过多数据, 该接口并不公开, 访问量不会太高
* `True`, `False`请用`1`, `0`代替
* 同时后台将会保存信息, 方便进行核对信息

返回示例:

```json
{
  "content": "操作成功", 
  "code": 200
}
```





